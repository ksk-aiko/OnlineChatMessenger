@startuml
|クライアント|
start
:CLIからユーザー名入力;
:サーバに接続要求;
:サーバとUDP接続を確立;

|サーバ|
start
:CLIからサーバ起動;
:バックグラウンドで接続待機;

|クライアント|
:メッセージを入力;
:サーバにメッセージ送信;

|サーバ|
:メッセージ受信;
:ユーザー名とメッセージを解析;
:他のクライアントにメッセージ転送;

|クライアント|
:メッセージ受信;

|サーバ|
:クライアントの状態を監視;

if (連続で失敗?) then (yes)
    :クライアントをリレーシステムから削除;
else (no)
    :クライアント接続維持;
endif

|クライアント|
:新しいメッセージを入力;

stop
@enduml
